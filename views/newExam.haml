.container
  .row
 


    .col-md-12.text-center
      %h3 Seleccione una pregunta y aÃ±Ã¡dela al exÃ¡men

    
    / %form#demoform{:action => "/examenes/new", :method => "post", :name => "form-new-exam", :role => "form"}
    /   %select{:multiple => "multiple", :name => "duallistbox_demo1[]", :size => @preguntas.count}
    /     - @preguntas.each do |pregunta|
    /       %option{:value => pregunta[:idPregunta]} #{pregunta[:titulo]}
    /   /%br
    /   /  %button.btn.btn-primary{:type => "submit"} Guardar
    / :javascript
    /   var demo1 = $('select[name="duallistbox_demo1[]"]').bootstrapDualListbox();
    /   $("#demoform").submit(function() {
    /     alert($('[name="duallistbox_demo1[]"]').val());
    /     return false;
    /   });

    / Para que no salte el submit cuando las preguntas se 
    / desplazan de un lado hacia el otro
    

    :javascript
      $(document).ready(function(){
        
        var enviar = false;

        $("#formulario").submit(function(event) {
          event.preventDefault();
        });

        $("#guardar").click(function() {
          var datos;
          var i = 0;

          $("ul.lista-derecha > li").each(function(index) {
            if (i == 0) {
              datos = $(this).val();
            }
            else {
              datos = datos + "," + $(this).val();
            }
            i++;
          });

          //var datos = { id: '1','2','3' };

          $.ajax({
            url: "/examenes/new",
            method: "post",
            data: { ids: datos }
          }).done(function() {
            //redirigir a donde quiera
            $("#formulario2").submit();
            //window.location.href = "/examenes";
          })

        });

      });

    %form#formulario2{:action => "/examenes/redireccion", :method => "post"}

    %form#formulario{:action => "/examenes/new", :method => "post", :name => "form-new-exam", :role => "form"}
      / Lista de la izquierda
      .dual-list.list-left.col-md-5
        .well.text-right
          .row
            .col-md-10
              .input-group
                %span.input-group-addon.glyphicon.glyphicon-search
                %input.form-control{:name => "SearchDualList", :placeholder => "Buscar", :type => "text"}/
            .col-md-2
              .btn-group
                %a.btn.btn-default.selector{:title => "Seleccionar todo"}
                  %i.glyphicon.glyphicon-unchecked

          %ul.list-group
            - @preguntas.each do |pregunta|
              %li.list-group-item{:value => pregunta[:idPregunta]}
                %span.titulo
                  =pregunta[:titulo]
                %br
                %span.fecha
                  =pregunta[:fecha_creacion].strftime("%c")

      / Botones de desplazamiento
      .list-arrows.col-md-1.text-center
        %button.btn.btn-default.btn-sm.move-left{:id => "boton1"} 
          %span.glyphicon.glyphicon-chevron-left
        %button.btn.btn-default.btn-sm.move-right{:id => "boton2"}
          %span.glyphicon.glyphicon-chevron-right

      / Lista de la derecha
      .dual-list.list-right.col-md-5
        .well
          .row
            .col-md-2
              .btn-group
                %a.btn.btn-default.selector{:title => "Seleccionar todo"}
                  %i.glyphicon.glyphicon-unchecked
            .col-md-10
              .input-group
                %input.form-control{:name => "SearchDualList", :placeholder => "Buscar", :type => "text"}/
                %span.input-group-addon.glyphicon.glyphicon-search
          %ul.list-group{:class => "lista-derecha"}

      %button.btn.btn-primary{:type => "submit", :id => "guardar"} Guardar